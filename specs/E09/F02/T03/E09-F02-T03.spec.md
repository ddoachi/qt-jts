# Spec: E09-F02-T03 - Implement StrategyLibraryUseCase

---
# ============================================================================
# SPEC METADATA
# ============================================================================

# === IDENTIFICATION ===
id: E09-F02-T03
clickup_task_id: '86ew0fp00'
title: Implement StrategyLibraryUseCase
type: task

# === HIERARCHY ===
parent: E09-F02
children: []
epic: E09
feature: F02
task: T03
domain: strategy

# === WORKFLOW ===
status: draft
priority: high

# === TRACKING ===
created: '2025-12-30'
updated: '2025-12-30'
due_date: ''
estimated_hours: 4
actual_hours: 0

# === METADATA ===
tags:
  - use-case
  - strategy
  - library
  - duplicate
effort: medium
risk: low
---

**Status**: Draft
**Type**: Task
**Parent**: E09-F02
**Created**: 2025-12-30
**Updated**: 2025-12-30

## Executive Summary

Implement the StrategyLibraryUseCase for managing strategy collections. Provides listing with summary previews, strategy duplication for creating variations, and activate/deactivate functionality.

## Execution Flow

```
1. List all strategies
   → Load from repository
   → Create StrategySummary for each
   → Truncate expression previews
2. Duplicate strategy
   → Load existing by ID
   → Create copy with new name
   → Reset version to 1
   → Save to repository
3. Toggle active status
   → Update is_active flag
   → Return: SUCCESS with library operations ready
```

## User Stories

### Primary User Story
**As a** trader
**I want to** manage my strategy library
**So that** I can organize and duplicate strategies

## Acceptance Scenarios

### Scenario 1: List Strategies
**Given** 5 strategies in repository
**When** list_all() is called
**Then** list of 5 StrategySummary objects returned

### Scenario 2: Duplicate Strategy
**Given** strategy "RSI Momentum" with id=1
**When** duplicate(1, "RSI Momentum v2") is called
**Then** new strategy created with version=1

### Scenario 3: Deactivate Strategy
**Given** active strategy with id=1
**When** deactivate(1) is called
**Then** strategy.is_active becomes False

## Requirements

### Functional Requirements
- **FR-001**: list_all() returns StrategySummary list
- **FR-002**: StrategySummary includes entry_rule_preview (truncated)
- **FR-003**: duplicate() creates copy with new name
- **FR-004**: activate/deactivate toggles is_active

### Non-Functional Requirements
- **NFR-001**: Preview truncates to 50 characters
- **NFR-002**: Async I/O

### Technical Constraints
- **TC-001**: Uses IStrategyRepository

## Dependencies

### Upstream Dependencies
- [ ] E09-F01: Domain entities
- [ ] E09-F03-T01: Repository interface

### Downstream Impact
- [ ] E09-F04: UI calls this use case

## Gate Checks

### Pre-Implementation Gates
- [x] StrategySummary type defined
- [x] Operations clear

### Quality Gates
- [ ] Unit tests for use case
- [ ] Test coverage > 80%

## Success Criteria

### Acceptance Criteria
- [ ] Use case implemented
- [ ] List with preview working
- [ ] Duplicate working
- [ ] Tests passing

### Definition of Done
- [ ] Code reviewed
- [ ] Unit tests passing
- [ ] Documentation complete

## Risk Assessment

| Risk | Probability | Impact | Mitigation |
|------|-------------|--------|------------|
| None significant | - | - | - |

## Artifacts

### Input Documents
- [Parent Feature](../E09-F02.spec.md)
- [Epic Section 4.3](../../E09.spec.md)

### Output Artifacts
- `src/application/use_cases/strategy_library.py`

---
*Template Version: 2.0.0 - Enhanced with Speckit features*
