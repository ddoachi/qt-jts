# Spec: E09-F04-T05 - Create RiskConfigWidget

---
# ============================================================================
# SPEC METADATA
# ============================================================================

# === IDENTIFICATION ===
id: E09-F04-T05
clickup_task_id: '86ew0fp0t'
title: Create RiskConfigWidget
type: task

# === HIERARCHY ===
parent: E09-F04
children: []
epic: E09
feature: F04
task: T05
domain: strategy

# === WORKFLOW ===
status: draft
priority: high

# === TRACKING ===
created: '2025-12-30'
updated: '2025-12-30'
due_date: ''
estimated_hours: 4
actual_hours: 0

# === METADATA ===
tags:
  - ui
  - qt
  - widget
  - risk
  - config
effort: medium
risk: low
---

**Status**: Draft
**Type**: Task
**Parent**: E09-F04
**Created**: 2025-12-30
**Updated**: 2025-12-30

## Executive Summary

Create the RiskConfigWidget for configuring position sizing and risk management parameters. Features spin boxes for all risk parameters (stop-loss, take-profit, position size, max positions, daily loss limit) with real-time validation and config_changed signal emission.

## Execution Flow

```
1. Create RiskConfigWidget(QWidget)
   → Form layout with spin boxes
2. Add spin boxes for each parameter
   → Stop-Loss % (negative, -50 to 0)
   → Take-Profit % (0 to 100)
   → Position Size % (1 to 100)
   → Max Positions (1 to 50)
   → Max Daily Loss % (0 to 100, optional)
3. Connect value changes
   → Emit config_changed(RiskConfig) on any change
4. Provide get/set methods
   → get_config() -> RiskConfig
   → set_config(RiskConfig)
   → Return: SUCCESS with widget ready
```

## User Stories

### Primary User Story
**As a** trader
**I want to** configure risk parameters
**So that** I can control position sizing and loss limits

## Acceptance Scenarios

### Scenario 1: Set Stop-Loss
**Given** RiskConfigWidget displayed
**When** user sets stop-loss to -3%
**Then** config_changed emits with stop_loss_pct=3.0

### Scenario 2: Load Existing Config
**Given** RiskConfig with position_size=15
**When** set_config() is called
**Then** spin box shows 15

### Scenario 3: Get Current Config
**Given** all spin boxes with values
**When** get_config() is called
**Then** RiskConfig with all values returned

## Requirements

### Functional Requirements
- **FR-001**: Spin boxes for all risk parameters
- **FR-002**: Proper value ranges and suffixes
- **FR-003**: config_changed signal on any change
- **FR-004**: get_config() and set_config() methods

### Non-Functional Requirements
- **NFR-001**: Real-time updates (no delay)
- **NFR-002**: Clear labels and suffixes

### Technical Constraints
- **TC-001**: QDoubleSpinBox and QSpinBox
- **TC-002**: QFormLayout

## Dependencies

### Upstream Dependencies
- [ ] E09-F01-T02: RiskConfig entity
- [ ] E09-F04-T03: Embedded in editor

### Downstream Impact
- [ ] None (leaf widget, reusable)

## Gate Checks

### Pre-Implementation Gates
- [x] Parameter ranges defined
- [x] Widget layout in E09 spec Section 5.3

### Quality Gates
- [ ] Widget tests
- [ ] Range validation tests
- [ ] Test coverage > 80%

## Success Criteria

### Acceptance Criteria
- [ ] All spin boxes implemented
- [ ] Ranges correct
- [ ] Signal emission working
- [ ] get/set methods working
- [ ] Tests passing

### Definition of Done
- [ ] Code reviewed
- [ ] Widget tests passing
- [ ] Documentation complete

## Risk Assessment

| Risk | Probability | Impact | Mitigation |
|------|-------------|--------|------------|
| Value conversion issues | Low | Low | Use Decimal consistently |

## Artifacts

### Input Documents
- [Parent Feature](../E09-F04.spec.md)
- [Epic Section 5.3](../../E09.spec.md)

### Output Artifacts
- `src/presentation/views/strategy/risk_config_widget.py`

---
*Template Version: 2.0.0 - Enhanced with Speckit features*
