---
# ============================================================================
# SPEC METADATA
# ============================================================================

# === IDENTIFICATION ===
id: E04-F05-T02
clickup_task_id: '86ew020dv'
title: Create CollectionProgressWidget
type: task

# === HIERARCHY ===
parent: E04-F05
children: []
epic: E04
feature: F05
task: T02
domain: data-collection

# === WORKFLOW ===
status: draft
priority: medium

# === TRACKING ===
created: '2025-01-15'
updated: '2025-01-15'
due_date: ''
estimated_hours: 8
actual_hours: 0

# === METADATA ===
tags: [ui, widget, pyside6, progress, real-time]
effort: large
risk: low
---

# Spec: E04-F05-T02 - Create CollectionProgressWidget

**Status**: Draft
**Type**: Task
**Parent**: E04-F05
**Created**: 2025-01-15
**Updated**: 2025-01-15

## Executive Summary

Create the Qt/PySide6 widget for real-time collection progress monitoring. This widget displays live progress updates, statistics, recent activity log, and provides job control buttons (pause/resume/cancel).

## Execution Flow

```
1. Initialize widget
   → Setup UI with all sections
   → Create update timer

2. Receive progress updates
   → Update progress bar (0-100%)
   → Update count labels
   → Update time elapsed/remaining

3. Display recent activity
   → Add completed symbols to table
   → Show candle count and status
   → Auto-scroll to latest

4. Handle control actions
   → Pause button toggles to Resume
   → Stop button cancels job
   → Emit appropriate signals
```

## User Stories

### Primary User Story
**As a** trader
**I want to** see real-time collection progress
**So that** I know how the download is progressing

## Acceptance Scenarios

### Scenario 1: Progress Bar Update
**Given** 50 of 100 symbols completed
**When** set_progress() is called
**Then** progress bar shows 50%

### Scenario 2: Pause Toggle
**Given** widget in running state
**When** pause button is clicked
**Then** button text changes to "재개" (Resume)

### Scenario 3: Time Estimation
**Given** 50 symbols completed in 50 seconds
**When** progress is displayed
**Then** remaining time shows approximately 50 seconds

## Requirements

### Functional Requirements
- **FR-001**: Progress bar MUST update smoothly
- **FR-002**: Time estimates MUST be reasonable
- **FR-003**: Pause/Resume buttons MUST toggle correctly
- **FR-004**: Stop button MUST cancel collection
- **FR-005**: Activity log MUST show recent symbols

### Non-Functional Requirements
- **NFR-001**: Updates at 1 second interval
- **NFR-002**: No UI blocking during updates
- **NFR-003**: Memory stable during long operations

### Technical Constraints
- **TC-001**: Must use PySide6 widgets
- **TC-002**: Must use QTimer for periodic updates
- **TC-003**: Must be thread-safe for signal handling

## Key Entities

### Entity: CollectionProgressWidget
- **Signals**: pause_requested, resume_requested, stop_requested
- **Methods**: set_progress(progress), start_updates(), stop_updates()

## Dependencies

### Upstream Dependencies
- [x] E04-F03-T01: GetCollectionProgressUseCase
- [x] E04-F01-T02: CollectionProgress value object
- [x] E01: Application Framework

### Downstream Impact
- None (terminal widget)

## Success Criteria

### Acceptance Criteria
- [ ] Progress bar updates smoothly (no flickering)
- [ ] Time estimates are reasonable
- [ ] Pause/resume buttons toggle correctly
- [ ] Stop button cancels collection
- [ ] Activity log shows recent symbols

### Definition of Done
- [ ] Widget tests with pytest-qt
- [ ] Signal emission tests
- [ ] Visual state tests
- [ ] Memory usage stable over time

## Artifacts

### Output Files
```
src/presentation/widgets/
└── collection_progress_widget.py
```

---
*Template Version: 2.0.0 - Enhanced with Speckit features*
