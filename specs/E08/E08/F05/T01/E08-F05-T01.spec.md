# Spec: E08-F05-T01 - Create DiscoveryView Main Layout

---
# ============================================================================
# SPEC METADATA
# ============================================================================

# === IDENTIFICATION ===
id: E08-F05-T01
clickup_task_id: '86ew021b8'
title: Create DiscoveryView Main Layout
type: task

# === HIERARCHY ===
parent: E08-F05
children: []
epic: E08
feature: F05
task: T01
domain: discovery

# === WORKFLOW ===
status: draft
priority: high

# === TRACKING ===
created: '2025-12-28'
updated: '2025-12-28'
due_date: ''
estimated_hours: 3
actual_hours: 0

# === METADATA ===
tags: [ui, pyqt, widget, layout, view]
effort: medium
risk: low
---

**Status**: Draft
**Type**: Task
**Parent**: [E08-F05](../E08-F05.spec.md)
**Created**: 2025-12-28
**Updated**: 2025-12-28

## Executive Summary

Create the main DiscoveryView that provides the layout container for the pattern discovery workflow UI. This includes a step-by-step configuration panel, results panel, and navigation between them using QStackedWidget.

## Execution Flow

```
1. Initialize DiscoveryView with dependencies
   → Store use case and repository references
   → Call _setup_ui() and _connect_signals()

2. _setup_ui() creates main layout
   → Add title label "Pattern Discovery"
   → Create QStackedWidget for config/results panels
   → Create configuration panel (Steps 1-3)
   → Create results panel
   → Add to main layout

3. _create_config_panel() builds step-by-step UI
   → Step 1: EventSelectionWidget placeholder
   → Step 2: Discovery Type placeholder
   → Step 3: Outcome Parameters placeholder
   → Add "▶ 패턴 발견 시작" button
   → Return: panel widget

4. _create_results_panel() builds results UI
   → Add "← 설정으로 돌아가기" back button
   → Add DiscoveryResultsWidget placeholder
   → Return: panel widget

5. _on_start_discovery() handler
   → Emit discovery_started signal
   → Call use case (async)
   → Switch to results panel on success
```

## User Stories

### Primary User Story
**As a** trader
**I want to** see a step-by-step wizard for pattern discovery
**So that** the process is intuitive and guided

### Additional Stories
- **As a** user, **I want to** switch between config and results, **So that** I can refine my search
- **As a** developer, **I want to** slots for child widgets, **So that** components can be integrated

## Acceptance Scenarios

### Scenario 1: View Initialization
**Given** required dependencies are provided
**When** DiscoveryView is created
**Then** the view initializes with config panel visible

### Scenario 2: Step Groups Display
**Given** the config panel is shown
**When** I look at the layout
**Then** I see 3 step groups (Select Events, Discovery Type, Outcome Parameters)

### Scenario 3: Switch to Results
**Given** I click "패턴 발견 시작"
**When** discovery completes successfully
**Then** the results panel is shown

### Scenario 4: Back to Config
**Given** I am on the results panel
**When** I click "설정으로 돌아가기"
**Then** the config panel is shown

## Requirements

### Functional Requirements
- **FR-001**: View MUST have step-by-step group boxes
- **FR-002**: View MUST use QStackedWidget for panel switching
- **FR-003**: View MUST emit discovery_started and discovery_completed signals
- **FR-004**: View MUST have placeholders for child widgets

### Non-Functional Requirements
- **NFR-001**: Responsive layout
- **NFR-002**: Consistent styling with app theme
- **NFR-003**: Korean language support

### Technical Constraints
- **TC-001**: Must use PyQt6/PySide6
- **TC-002**: Must integrate with E01 base UI framework

## Key Entities

### Widget: DiscoveryView
- **Description**: Main view container with stacked configuration/results panels
- **Signals**: discovery_started(DiscoveryConfig), discovery_completed(list[DiscoveredRule])
- **Dependencies**: RunDiscoveryUseCase, IScanSessionRepository

## Dependencies

### Upstream Dependencies
- [x] E01: Base UI Framework
- [x] E08-F04: RunDiscoveryUseCase

### Downstream Impact
- [ ] E08-F05-T02: Integrates EventSelectionWidget
- [ ] E08-F05-T03: Integrates OutcomeConfigWidget
- [ ] E08-F05-T04: Integrates DiscoveryResultsWidget

## Gate Checks

### Pre-Implementation Gates
- [x] No [NEEDS CLARIFICATION] markers remain
- [x] Layout design specified
- [x] Widget hierarchy documented

### Quality Gates
- [ ] DiscoveryView implemented
- [ ] Widget structure tested
- [ ] Styling applied

## Success Criteria

### Acceptance Criteria
- [ ] `DiscoveryView` class with main layout
- [ ] Step-by-step group boxes for workflow
- [ ] QStackedWidget for config/results switch
- [ ] Start discovery button
- [ ] Signals for discovery events
- [ ] Placeholder slots for child widgets
- [ ] Back button in results view

### Definition of Done
- [ ] Basic styling applied
- [ ] Unit tests for widget structure
- [ ] Integration with base UI framework

## Risk Assessment

| Risk | Probability | Impact | Mitigation |
|------|------------|--------|------------|
| Layout complexity | Low | Low | Use Qt Designer if needed |
| Async UI updates | Low | Medium | Use signals/slots properly |

## Artifacts

### Input Documents
- [E08-F05 Discovery UI](../E08-F05.spec.md)
- E01: Base UI Framework
- PRD Section 5.3: Pattern Discovery UI

### Output Artifacts
- [ ] `src/presentation/views/discovery/discovery_view.py`
- [ ] `src/presentation/views/discovery/__init__.py`

---
*Template Version: 2.0.0*
