# Spec: E08-F05-T03 - Create OutcomeConfigWidget

---
# ============================================================================
# SPEC METADATA
# ============================================================================

# === IDENTIFICATION ===
id: E08-F05-T03
clickup_task_id: '86ew021cf'
title: Create OutcomeConfigWidget
type: task

# === HIERARCHY ===
parent: E08-F05
children: []
epic: E08
feature: F05
task: T03
domain: discovery

# === WORKFLOW ===
status: draft
priority: high

# === TRACKING ===
created: '2025-12-28'
updated: '2025-12-28'
due_date: ''
estimated_hours: 3
actual_hours: 0

# === METADATA ===
tags: [ui, pyqt, widget, configuration, form]
effort: medium
risk: low
---

**Status**: Draft
**Type**: Task
**Parent**: [E08-F05](../E08-F05.spec.md)
**Created**: 2025-12-28
**Updated**: 2025-12-28

## Executive Summary

Create a widget for configuring discovery type (Entry/Exit/Stop-Loss) and outcome parameters (lookahead period, thresholds, minimum samples). The widget provides radio buttons for type selection and spin boxes for parameter configuration.

## Execution Flow

```
1. Initialize OutcomeConfigWidget
   → Call _setup_ui() and _connect_signals()

2. _setup_ui() creates layout
   → Create Discovery Type group with radio buttons
   → Create Outcome Parameters group with form layout
   → Add QSpinBox for lookahead_period (1-30 days)
   → Add QDoubleSpinBox for success_threshold (+0.1% to +50%)
   → Add QDoubleSpinBox for failure_threshold (-50% to -0.1%)
   → Add QSpinBox for min_samples (10-500)

3. _connect_signals() wires up changes
   → Connect all input changes to _emit_config()

4. _emit_config() on any change
   → Build DiscoveryConfig from current values
   → Emit config_changed signal

5. get_config() returns current configuration
   → Convert percentages to decimals (3.0% → 0.03)
   → Return DiscoveryConfig

6. set_config() updates UI from config
   → Convert decimals to percentages (0.03 → 3.0%)
   → Update all input values
```

## User Stories

### Primary User Story
**As a** trader
**I want to** configure discovery parameters
**So that** I can customize the pattern search

### Additional Stories
- **As a** trader, **I want to** see defaults, **So that** I can start quickly
- **As a** trader, **I want to** percentage display, **So that** values are intuitive

## Acceptance Scenarios

### Scenario 1: Default Values
**Given** widget is created
**When** looking at default values
**Then** Entry type, 5 days, +3%, -2%, 30 samples are shown

### Scenario 2: Type Selection
**Given** widget is displayed
**When** I select "Exit Rules" radio
**Then** discovery_type becomes EXIT

### Scenario 3: Get Config
**Given** Entry type, 5 days, +3%, -2%, 30 samples
**When** get_config() is called
**Then** DiscoveryConfig with these values is returned

### Scenario 4: Set Config
**Given** a DiscoveryConfig with custom values
**When** set_config() is called
**Then** UI updates to show those values

### Scenario 5: Signal Emission
**Given** any input is changed
**When** change completes
**Then** config_changed signal is emitted with current config

### Scenario 6: Percentage Conversion
**Given** success_threshold displayed as 3.0%
**When** get_config() is called
**Then** config.success_threshold is 0.03

## Requirements

### Functional Requirements
- **FR-001**: Widget MUST have radio buttons for discovery type
- **FR-002**: Widget MUST have spin boxes for parameters
- **FR-003**: Widget MUST convert percentages to decimals
- **FR-004**: Widget MUST emit config_changed on any change

### Non-Functional Requirements
- **NFR-001**: Intuitive percentage display
- **NFR-002**: Clear labeling of parameters

### Technical Constraints
- **TC-001**: Must use PyQt6/PySide6 widgets
- **TC-002**: Must return valid DiscoveryConfig

## Key Entities

### Widget: OutcomeConfigWidget
- **Description**: Discovery type radios and parameter inputs
- **Signals**: config_changed(DiscoveryConfig)
- **Methods**: get_config(), set_config(config)

## Dependencies

### Upstream Dependencies
- [x] E08-F05-T01: DiscoveryView (parent integration)
- [x] E08-F01: DiscoveryConfig, DiscoveryType

### Downstream Impact
- None (leaf widget)

## Gate Checks

### Pre-Implementation Gates
- [x] No [NEEDS CLARIFICATION] markers remain
- [x] Layout design specified
- [x] Default values defined

### Quality Gates
- [ ] Widget implemented
- [ ] Percentage conversion works
- [ ] Unit tests written

## Success Criteria

### Acceptance Criteria
- [ ] `OutcomeConfigWidget` class implemented
- [ ] Radio buttons for discovery type
- [ ] Spin boxes for parameters
- [ ] Percentage conversion (display vs internal)
- [ ] `config_changed` signal emitted on change
- [ ] `get_config()` returns valid DiscoveryConfig
- [ ] `set_config()` updates UI

### Definition of Done
- [ ] Default values set correctly
- [ ] Unit tests for widget
- [ ] Integration with DiscoveryView

## Risk Assessment

| Risk | Probability | Impact | Mitigation |
|------|------------|--------|------------|
| Conversion errors | Low | Medium | Unit test conversions |
| Validation gaps | Low | Low | Use DiscoveryConfig validation |

## Artifacts

### Input Documents
- [E08-F05-T01 DiscoveryView](../T01/E08-F05-T01.spec.md)
- [E08-F01 Domain Model](../../F01/E08-F01.spec.md)
- PRD Section 5.3.3: Discovery Parameters

### Output Artifacts
- [ ] `src/presentation/views/discovery/outcome_config_widget.py`

---
*Template Version: 2.0.0*
