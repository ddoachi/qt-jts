# Spec: E08-F05 - Discovery UI

---
# ============================================================================
# SPEC METADATA
# ============================================================================

# === IDENTIFICATION ===
id: E08-F05
clickup_task_id: ''
title: Discovery UI
type: feature

# === HIERARCHY ===
parent: E08
children: [E08-F05-T01, E08-F05-T02, E08-F05-T03, E08-F05-T04, E08-F05-T05]
epic: E08
feature: F05
task: ''
domain: discovery

# === WORKFLOW ===
status: draft
priority: high

# === TRACKING ===
created: '2025-12-28'
updated: '2025-12-28'
due_date: ''
estimated_hours: 12
actual_hours: 0

# === METADATA ===
tags: [ui, pyqt, widgets, presentation]
effort: large
risk: medium
---

**Status**: Draft
**Type**: Feature
**Parent**: [E08](../E08.spec.md)
**Created**: 2025-12-28
**Updated**: 2025-12-28

## Executive Summary

Create the UI components for the pattern discovery workflow. This includes the main DiscoveryView with a step-by-step wizard interface, event selection, configuration widgets, results display, and rule review dialogs.

## Execution Flow

```
1. User opens Pattern Discovery view
   → Show configuration panel (Steps 1-3)

2. Step 1: Select Events
   → EventSelectionWidget shows available scan sessions
   → User selects a session

3. Step 2: Discovery Type
   → Radio buttons for Entry/Exit/Stop-Loss
   → Default: Entry

4. Step 3: Outcome Parameters
   → Configure lookahead, thresholds, min samples
   → Show defaults

5. User clicks "패턴 발견 시작"
   → Show progress indicator
   → Call RunDiscoveryUseCase
   → If error: Show error message
   → If success: Switch to results panel

6. Results panel
   → Show DiscoveryResultsWidget with ranked rules
   → User can click "자세히 보기" to open RuleReviewWidget
   → User can click "전략에 추가" to add to strategy library
```

## User Stories

### Primary User Story
**As a** trader
**I want to** use a step-by-step wizard for pattern discovery
**So that** the process is intuitive and guided

### Additional Stories
- **As a** trader, **I want to** see clear statistics for each rule, **So that** I can evaluate quality
- **As a** trader, **I want to** review sample matches, **So that** I can validate the pattern

## Acceptance Scenarios

### Scenario 1: Complete Workflow
**Given** I am on the Pattern Discovery view
**When** I select events, configure parameters, and click start
**Then** discovered rules are displayed in ranked order

### Scenario 2: View Rule Details
**Given** discovered rules are displayed
**When** I click "자세히 보기" on a rule
**Then** RuleReviewWidget opens with full statistics and samples

### Scenario 3: Add to Strategy
**Given** discovered rules are displayed
**When** I click "전략에 추가" on a rule
**Then** the rule is added to my strategy library

## Requirements

### Functional Requirements
- **FR-001**: DiscoveryView MUST show step-by-step configuration
- **FR-002**: EventSelectionWidget MUST list available scan sessions
- **FR-003**: OutcomeConfigWidget MUST allow parameter configuration
- **FR-004**: DiscoveryResultsWidget MUST show rules ranked by profit factor
- **FR-005**: RuleReviewWidget MUST show all statistics and samples

### Non-Functional Requirements
- **NFR-001**: Responsive layout
- **NFR-002**: Korean language support
- **NFR-003**: Consistent styling with app theme

### Technical Constraints
- **TC-001**: Must use PyQt6/PySide6
- **TC-002**: Must integrate with E01 base UI framework

## Key Entities

### Widget: DiscoveryView
- **Description**: Main view container with stacked configuration/results panels
- **Signals**: discovery_started, discovery_completed

### Widget: EventSelectionWidget
- **Description**: Dropdown for selecting scan sessions
- **Signals**: selection_changed

### Widget: OutcomeConfigWidget
- **Description**: Discovery type radios and parameter inputs
- **Signals**: config_changed

### Widget: DiscoveryResultsWidget
- **Description**: Scrollable list of rule cards
- **Signals**: rule_selected, add_to_strategy_requested

### Widget: RuleReviewWidget (Dialog)
- **Description**: Detailed rule review with statistics table
- **Signals**: add_to_strategy_requested

## Dependencies

### Upstream Dependencies
- [x] E08-F01: Domain entities for display
- [x] E08-F04: RunDiscoveryUseCase
- [x] E01: Base UI framework

### Downstream Impact
- [ ] None (presentation layer)

## Tasks Preview

| Task ID | Title | Effort | Dependencies |
|---------|-------|--------|--------------|
| [E08-F05-T01](T01/E08-F05-T01.spec.md) | Create DiscoveryView main layout | M | E01 |
| [E08-F05-T02](T02/E08-F05-T02.spec.md) | Create EventSelectionWidget | M | T01 |
| [E08-F05-T03](T03/E08-F05-T03.spec.md) | Create OutcomeConfigWidget | M | T01 |
| [E08-F05-T04](T04/E08-F05-T04.spec.md) | Create DiscoveryResultsWidget | L | T01, F01 |
| [E08-F05-T05](T05/E08-F05-T05.spec.md) | Create RuleReviewWidget | M | T04 |

## Gate Checks

### Pre-Implementation Gates
- [x] No [NEEDS CLARIFICATION] markers remain
- [x] UI mockups defined
- [x] Widget hierarchy documented

### Quality Gates
- [ ] All widgets implemented
- [ ] UI tests written
- [ ] Korean translations complete

## Success Criteria

### Acceptance Criteria (PRD)
- [ ] Select scan results as discovery input
- [ ] Configure discovery type (Entry/Exit/Stop-Loss)
- [ ] Configure outcome parameters
- [ ] Display discovered rules with statistics
- [ ] Show sample matches for validation
- [ ] Add discovered rules to strategy library

### Definition of Done
- [ ] All widgets implemented
- [ ] UI tests passing
- [ ] Responsive layout validated
- [ ] Korean language support

## Risk Assessment

| Risk | Probability | Impact | Mitigation |
|------|------------|--------|------------|
| Complex layout issues | Medium | Low | Use Qt Designer, test early |
| Async UI updates | Low | Medium | Use signals/slots properly |

## Artifacts

### Input Documents
- [E08-F04 Use Cases](../F04/E08-F04.spec.md)
- PRD Section 5.3 UI mockups

### Output Artifacts
- [ ] `src/presentation/views/discovery/discovery_view.py`
- [ ] `src/presentation/views/discovery/event_selection_widget.py`
- [ ] `src/presentation/views/discovery/outcome_config_widget.py`
- [ ] `src/presentation/views/discovery/discovery_results_widget.py`
- [ ] `src/presentation/views/discovery/rule_review_widget.py`

---
*Template Version: 2.0.0*
