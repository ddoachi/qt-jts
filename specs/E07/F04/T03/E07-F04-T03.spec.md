---
# ============================================================================
# SPEC METADATA
# ============================================================================

# === IDENTIFICATION ===
id: E07-F04-T03
clickup_task_id: '86ew020t6'
title: Create ScanResultsWidget
type: task

# === HIERARCHY ===
parent: E07-F04
children: []
epic: E07
feature: F04
task: T03
domain: scanner

# === WORKFLOW ===
status: draft
priority: high

# === TRACKING ===
created: '2025-12-28'
updated: '2025-12-28'
due_date: ''
estimated_hours: 8
actual_hours: 0

# === METADATA ===
tags:
  - ui
  - widget
  - table
effort: large
risk: medium
wave: 3
---

# Spec: E07-F04-T03 - Create ScanResultsWidget

**Status**: Draft
**Type**: Task
**Parent**: [E07-F04](../E07-F04.spec.md)
**Created**: 2025-12-28
**Updated**: 2025-12-28

## Executive Summary

Create results table widget with sortable columns, row selection, progress indicator during scan, and export functionality.

## Execution Flow

```
1. Create widget layout
   → Header with count label and export button
   → Progress bar (hidden initially)
   → QTableWidget with columns

2. Configure table
   → Set columns: Symbol, Name, Time, Close, Vol Ratio
   → Enable sorting
   → Enable row selection
   → Set alternating row colors

3. Display results
   → Convert ScanResults to table rows
   → Format values (currency, percentage)
   → Store ScanMatch in row data

4. Handle interactions
   → Row click: emit match_selected
   → Export button: show format menu
   → Return: SUCCESS with widget
```

## User Stories

### Primary User Story
**As a** trader
**I want to** view and interact with scan results
**So that** I can analyze matches

## Acceptance Scenarios

### Scenario 1: Display Results
**Given** scan completed with 47 matches
**When** set_results() called
**Then** table shows 47 rows with formatted values

### Scenario 2: Sort by Column
**Given** results displayed
**When** I click "Close" header
**Then** rows sorted by close price

### Scenario 3: Select Row
**Given** results displayed
**When** I click a row
**Then** match_selected signal emitted with ScanMatch

### Scenario 4: Progress Display
**Given** scan is running
**When** show_progress() called
**Then** progress bar visible with percentage

## Requirements

### Functional Requirements
- **FR-001**: MUST display results in sortable table
- **FR-002**: MUST format currency and percentages
- **FR-003**: MUST emit match_selected on row click
- **FR-004**: MUST show progress during scan
- **FR-005**: MUST have export menu

### Non-Functional Requirements
- **NFR-001**: Handle 1000 rows without lag
- **NFR-002**: Sort in < 100ms

### Technical Constraints
- **TC-001**: Use QTableWidget
- **TC-002**: Store ScanMatch in item data

## Key Entities

### Class: ScanResultsWidget
```python
class ScanResultsWidget(QWidget):
    match_selected = Signal(object)
    export_csv_requested = Signal(list)
    export_excel_requested = Signal(list)

    def set_results(self, results: ScanResults) -> None
    def show_progress(self, progress: ScanProgress) -> None
    def clear(self) -> None
    def get_selected_match(self) -> Optional[ScanMatch]
```

## Dependencies

### Upstream Dependencies
- [ ] E07-F01-T02: ScanResults, ScanMatch
- [ ] E07-F04-T01: ScannerView container

### Downstream Impact
- [ ] E07-F05: Export uses results

## Gate Checks

### Pre-Implementation Gates
- [ ] E07-F04-T01 complete
- [ ] E07-F01-T02 complete

### Quality Gates
- [ ] Sorting tested
- [ ] Selection tested
- [ ] 80% test coverage

## Success Criteria

### Acceptance Criteria
- [ ] Results display correctly
- [ ] Sorting works
- [ ] Selection signals work
- [ ] Progress shows during scan

### Definition of Done
- [ ] Code reviewed
- [ ] UI tests passing
- [ ] Korean characters display correctly

## Artifacts

### Input Documents
- [Feature Spec](../E07-F04.spec.md)

### Output Artifacts
- [ ] `src/presentation/views/scanner/scan_results_widget.py`

---
*Template Version: 2.0.0*
