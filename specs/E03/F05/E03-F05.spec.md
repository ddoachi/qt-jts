# Spec: E03-F05 - UI Components

---
# ============================================================================
# SPEC METADATA
# ============================================================================

# === IDENTIFICATION ===
id: E03-F05
clickup_task_id: ''
title: UI Components
type: feature

# === HIERARCHY ===
parent: E03
children:
  - E03-F05-T01
  - E03-F05-T02
epic: E03
feature: F05
task: null
domain: broker

# === WORKFLOW ===
status: draft
priority: medium

# === TRACKING ===
created: '2025-12-28'
updated: '2025-12-28'
due_date: ''
estimated_hours: 16
actual_hours: 0

# === METADATA ===
tags:
  - ui
  - widgets
  - qt
  - visualization
effort: medium
risk: low
---

**Status**: Draft
**Type**: Feature
**Parent**: E03
**Created**: 2025-12-28
**Updated**: 2025-12-28

## Executive Summary

Implement Qt-based UI components for broker status visualization, including a rate limit indicator widget showing real-time API usage and a broker status widget showing connection state and account info. These widgets are reusable components that integrate into the main dashboard and trading screens.

## Execution Flow

```
1. Create RateLimitIndicator widget
   ‚Üí Progress bar with usage percentage
   ‚Üí Color-coded status (green/orange/red)
   ‚Üí Real-time updates via timer
2. Create BrokerStatusWidget
   ‚Üí Connection status indicator
   ‚Üí Account list with balances
   ‚Üí Embedded rate limit indicator
   ‚Üí Return: SUCCESS with widgets ready
```

## User Stories

### Primary User Story
**As a** user
**I want to** see real-time rate limit usage
**So that** I know when I'm approaching API limits

### Additional Stories
- **As a** user, **I want to** see broker connection status, **So that** I know if my brokers are connected
- **As a** user, **I want to** see account balances at a glance, **So that** I can monitor my accounts

## Acceptance Scenarios

### Scenario 1: Rate Limit Display
**Given** rate limiter at 60% usage
**When** widget updates
**Then** progress bar shows 60%, status is "Ï†ïÏÉÅ" (green)

### Scenario 2: Rate Limit Warning
**Given** rate limiter at 80% usage
**When** widget updates
**Then** status changes to "Ï£ºÏùò" (orange)

### Scenario 3: Broker Status Display
**Given** connected broker with 2 accounts
**When** widget is displayed
**Then** both accounts shown with balances

## Requirements

### Functional Requirements
- **FR-001**: RateLimitIndicator shows progress bar with current usage
- **FR-002**: Status text updates based on thresholds (Ï†ïÏÉÅ/Ï£ºÏùò/Ï†úÌïú)
- **FR-003**: BrokerStatusWidget displays all accounts with balances
- **FR-004**: Connection status indicator (connected/disconnected)

### Non-Functional Requirements
- **NFR-001**: Smooth animation on progress bar updates
- **NFR-002**: < 16ms update latency (60 FPS capable)
- **NFR-003**: Widgets scale properly with different screen sizes

### Technical Constraints
- **TC-001**: Use PySide6/Qt for widgets
- **TC-002**: Support Korean text (UTF-8)
- **TC-003**: Use QTimer for periodic updates

## Key Entities

### Entity: RateLimitIndicator
- **Description**: Visual rate limit indicator widget
- **Key Attributes**: progress_bar, usage_label, status_label
- **Relationships**: Uses RateLimiter

### Entity: BrokerStatusWidget
- **Description**: Broker status display widget
- **Key Attributes**: broker_info, gateway, accounts, rate_indicator
- **Relationships**: Uses BrokerRegistry data

## Dependencies

### Upstream Dependencies
- [ ] E03-F01-T03: RateLimiter implementation
- [ ] E03-F04-T01: BrokerRegistry for broker data
- [ ] E01: Qt framework

### Downstream Impact
- [ ] Dashboard: Will embed these widgets

## Gate Checks

### Pre-Implementation Gates
- [x] RateLimiter ready (F01-T03)
- [x] Qt framework available (E01)

### Quality Gates
- [ ] Widget tests
- [ ] Visual regression tests
- [ ] Responsive layout tested

## Tasks Preview

| ID | Title | Effort | Wave | Dependencies |
|----|-------|--------|------|--------------|
| [E03-F05-T01](T01/E03-F05-T01.spec.md) | Create RateLimitIndicator widget | M | 2 | F01-T03 |
| [E03-F05-T02](T02/E03-F05-T02.spec.md) | Create BrokerStatusWidget | L | 4 | F04-T01, T01 |

## Success Criteria

### Acceptance Criteria
- [ ] Rate limit indicator working
- [ ] Status colors correct
- [ ] Broker status displaying correctly
- [ ] Korean text rendering properly

### Definition of Done
- [ ] Code reviewed
- [ ] Widget tests passing
- [ ] Visual QA complete

## Risk Assessment

| Risk | Probability | Impact | Mitigation |
|------|-------------|--------|------------|
| UI flickering | Low | Medium | Use double buffering |
| Font issues | Low | Low | Embed Korean fonts |

## Notes and Clarifications

### Decisions Made
- 2025-12-28: Use QTimer for 100ms update interval
- 2025-12-28: Color thresholds at 70% and 90%

## Artifacts

### Input Documents
- [Parent Epic](../E03.spec.md)
- PRD Section 5.0.3: Rate Limiter indicators

### Output Artifacts
- [ ] `E03-F05.pre-docs.md` - Pre-implementation documentation

## UI Mockups

### Rate Limit Indicator
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Rate: ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë  12/15 req/s  Ï†ïÏÉÅ        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Broker Status Widget
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ KIS (ÌïúÍµ≠Ìà¨ÏûêÏ¶ùÍ∂å)                          ‚óè Connected     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Accounts:                                   [üîÑ] [‚öôÔ∏è]       ‚îÇ
‚îÇ ‚îú‚îÄ 50012345-01 (Ïã§Ï†ÑÌà¨Ïûê)     ‚Ç©52,340,000          [‚òÖ]     ‚îÇ
‚îÇ ‚îî‚îÄ 50012345-02 (Î™®ÏùòÌà¨Ïûê)     ‚Ç©100,000,000                  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Rate: ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë  16/20 req/s                 [Ï†ïÏÉÅ]   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## References

- PRD Section 5.0.3: Rate Limit Status Indicators
- Qt StyleSheets documentation

---
*Template Version: 2.0.0 - Enhanced with Speckit features*
