# Spec: E03-F03-T01 - Implement MockBrokerGateway

---
# ============================================================================
# SPEC METADATA
# ============================================================================

# === IDENTIFICATION ===
id: E03-F03-T01
clickup_task_id: '86ew01zzf'
title: Implement MockBrokerGateway
type: task

# === HIERARCHY ===
parent: E03-F03
children: []
epic: E03
feature: F03
task: T01
domain: broker

# === WORKFLOW ===
status: draft
priority: medium

# === TRACKING ===
created: '2025-12-28'
updated: '2025-12-28'
due_date: ''
estimated_hours: 4
actual_hours: 0

# === METADATA ===
tags:
  - mock
  - testing
  - gateway
  - simulation
effort: medium
risk: low
---

**Status**: Draft
**Type**: Task
**Parent**: E03-F03
**Created**: 2025-12-28
**Updated**: 2025-12-28

## Executive Summary

Create a mock broker gateway for testing and offline development that implements all IBrokerGateway methods, provides configurable mock responses, and simulates realistic broker behavior with in-memory state.

## Execution Flow

```
1. Create MockState dataclass
   → Store balance, positions, orders, candles
   → Provide default mock data
2. Implement MockBrokerGateway
   → Inherit from IBrokerGateway
   → Use MockState for data
3. Implement all gateway methods
   → Return cached or generated data
   → Track orders in state
4. Add configuration methods
   → load_candles(), set_balance(), add_position()
   → Return: SUCCESS with mock gateway ready
```

## User Stories

### Primary User Story
**As a** developer
**I want to** use a mock broker gateway
**So that** I can develop without real broker connections

## Acceptance Scenarios

### Scenario 1: Get Mock Balance
**Given** MockBrokerGateway initialized
**When** get_balance() is called
**Then** default mock balance is returned

### Scenario 2: Place Mock Order
**Given** mock gateway with balance
**When** place_order() is called
**Then** order is tracked and can be queried

### Scenario 3: Load Custom Data
**Given** mock gateway
**When** load_candles() is called with custom data
**Then** get_candles() returns that data

## Requirements

### Functional Requirements
- **FR-001**: Implement all IBrokerGateway methods
- **FR-002**: Configurable mock state
- **FR-003**: Order tracking with status updates
- **FR-004**: Default mock data for common cases

### Non-Functional Requirements
- **NFR-001**: No external dependencies
- **NFR-002**: Fast execution (no I/O)

### Technical Constraints
- **TC-001**: Pure Python implementation
- **TC-002**: Same interface as real gateway

## Dependencies

### Upstream Dependencies
- [ ] E03-F01: IBrokerGateway interface

### Downstream Impact
- [ ] E03-F04: Registry can use mock gateway
- [ ] All tests use mock gateway

## Gate Checks

### Pre-Implementation Gates
- [x] Interface defined (F01)

### Quality Gates
- [ ] Unit tests for all methods
- [ ] Order lifecycle tests

## Success Criteria

### Acceptance Criteria
- [ ] All methods implemented
- [ ] Mock data configurable
- [ ] Tests passing

### Definition of Done
- [ ] Code reviewed
- [ ] Tests passing

## Artifacts

### Input Documents
- [Parent Feature](../E03-F03.spec.md)

### Output Artifacts
- `src/infrastructure/mock/mock_broker_gateway.py`
- `src/infrastructure/mock/mock_data.py`

---
*Template Version: 2.0.0 - Enhanced with Speckit features*
