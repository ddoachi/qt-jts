# Spec: E12-F04-T02 - Create PortfolioWidget

---
# ============================================================================
# SPEC METADATA
# ============================================================================

# === IDENTIFICATION ===
id: E12-F04-T02
clickup_task_id: ''
title: Create PortfolioWidget
type: task

# === HIERARCHY ===
parent: E12-F04
children: []
epic: E12
feature: F04
task: T02
domain: paper-trading

# === WORKFLOW ===
status: draft
priority: high

# === TRACKING ===
created: '2025-12-30'
updated: '2025-12-30'
due_date: ''
estimated_hours: 5
actual_hours: 0

# === METADATA ===
tags:
  - ui
  - widget
  - portfolio
  - table
effort: medium
risk: low
---

**Status**: Draft
**Type**: Task
**Parent**: E12-F04
**Created**: 2025-12-30
**Updated**: 2025-12-30

## Executive Summary

Create `PortfolioWidget` that displays virtual portfolio value and positions table. Shows total portfolio value with P&L percentage in header. Positions table includes symbol, name, quantity, avg price, current price, and P&L with color coding (green for gains, red for losses).

## Execution Flow

```
1. Create widget class
   → Inherit from QWidget
   → Define position_selected signal
2. Setup UI components
   → Header: Portfolio value and P&L %
   → QTableWidget for positions
3. Implement set_portfolio method
   → Update header values
   → Populate table rows
   → Apply color coding
4. Implement selection handling
   → Emit position_selected(symbol)
   → Return: SUCCESS with widget working
```

## User Stories

### Primary User Story
**As a** trader
**I want to** see my virtual positions
**So that** I can monitor performance at a glance

## Acceptance Scenarios

### Scenario 1: Display Portfolio Value
**Given** portfolio with total_value=103,250,000
**Then** header shows "Portfolio Value: ₩103,250,000"

### Scenario 2: Display P&L Percentage
**Given** portfolio with +3.25% gain
**Then** shows "(+3.25%)" in green

### Scenario 3: Position Row
**Given** position in 005930 with unrealized_pnl +2.1%
**Then** row shows all fields with P&L in green

### Scenario 4: Selection Signal
**Given** user clicks position row
**Then** position_selected(005930) is emitted

## Requirements

### Functional Requirements
- **FR-001**: Header with total value and P&L
- **FR-002**: Positions table with all columns
- **FR-003**: Color-coded P&L (green/red)
- **FR-004**: Position selection signal

### Non-Functional Requirements
- **NFR-001**: Update within 100ms
- **NFR-002**: Clear number formatting (₩, %, commas)

### Technical Constraints
- **TC-001**: PySide6 QTableWidget
- **TC-002**: Korean currency format

## Dependencies

### Upstream Dependencies
- [ ] E12-F04-T01: Parent view
- [ ] E12-F01-T02: Portfolio entities

### Downstream Impact
- None (display only)

## Gate Checks

### Pre-Implementation Gates
- [x] Parent view implemented
- [x] Portfolio entity defined

### Quality Gates
- [ ] Visual review
- [ ] Test coverage > 80%

## Success Criteria

### Acceptance Criteria
- [ ] Values display correctly
- [ ] Color coding works
- [ ] Selection works
- [ ] Formatting correct

### Definition of Done
- [ ] Code reviewed
- [ ] Visual review passed
- [ ] Documentation complete

## Artifacts

### Input Documents
- [Parent Feature](../E12-F04.spec.md)

### Output Artifacts
- `src/presentation/views/paper_trading/portfolio_widget.py`

---
*Template Version: 2.0.0 - Enhanced with Speckit features*
